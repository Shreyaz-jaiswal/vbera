<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Your Cart - VibeEra Accessories</title>

<style>
*{margin:0;padding:0;box-sizing:border-box;font-family:Segoe UI,sans-serif}
body{background:#fff;color:#222}
header{padding:20px 40px;display:flex;justify-content:space-between;border-bottom:1px solid #eee}
.logo{font-size:26px;font-weight:700}
section{padding:40px}
button{padding:10px 20px;background:black;color:white;border:none;cursor:pointer}
input,textarea{width:100%;padding:10px;margin:8px 0}
.cart,.invoice{background:#f5f5f5}
.invoice{display:none}
.empty-cart{text-align:center;padding:40px;color:#666}
.payment-section{background:#fff3cd;border:2px solid #ffeaa7;border-radius:8px;padding:20px;text-align:center}
.upi-id{font-size:22px;font-weight:bold;background:white;padding:10px;border-radius:6px;margin:10px 0}
.cod-btn{background:#00b894;margin-top:10px}
footer{background:black;color:white;text-align:center;padding:20px}
</style>
</head>

<body>

<header>
  <div class="logo">VibeEra</div>
  <div>
    <a href="index.html">‚Üê Continue Shopping</a>
  </div>
</header>

<!-- CART -->
<section class="cart">
  <h2>Your Cart</h2>
  <div id="cartItems"></div>
  <h3 id="total">Total: ‚Çπ0</h3>

  <div class="empty-cart" id="emptyCart" style="display:none">
    <h3>Your cart is empty</h3>
    <a href="index.html">‚Üê Start Shopping</a>
  </div>
</section>

<!-- BILLING -->
<section id="billing">
  <h2>Billing Details</h2>
  <input id="name" placeholder="Customer Name">
  <input id="phone" placeholder="Phone Number">
  <textarea id="address" placeholder="Delivery Address"></textarea>
  <button onclick="placeOrder()" id="placeOrderBtn" style="display:none">Place Order</button>
</section>

<!-- PAYMENT -->
<section id="paymentPage" style="display:none">
  <h2>Payment</h2>
  <div class="payment-section">
    <h3>UPI Payment</h3>
    <div class="upi-id">8318463749@fam</div>
    <p><strong>Amount: <span id="payAmount">‚Çπ0</span></strong></p>

    <h4>OR</h4>
    <button class="cod-btn" onclick="contactCOD()">Contact for COD</button>

    <br><br>
    <button onclick="generateInvoice()">‚úÖ Payment Done</button>
  </div>
</section>

<!-- INVOICE -->
<section class="invoice" id="invoice">
  <h2>Invoice</h2>
  <p id="invName"></p>
  <p id="invPhone"></p>
  <p id="invAddress"></p>
  <hr>
  <div id="invItems"></div>
  <h3 id="invTotal"></h3>
  <button onclick="window.print()">Print</button>
  <button onclick="window.location.href='index.html'" style="background:#666">New Order</button>
</section>

<footer>
¬© 2026 VibeEra Accessories | Contact: +918423702403
</footer>

<!-- EMAILJS -->
<script src="https://cdn.jsdelivr.net/npm/@emailjs/browser@4/dist/email.min.js"></script>
<script>
emailjs.init("jO44k4Y07o-bKvnph");

const OWNER_PHONE = "918423702403";
let cart = JSON.parse(localStorage.getItem("vibeera_cart")) || [];
let total = parseInt(localStorage.getItem("vibeera_total")) || 0;
let customer = {};

function renderCart(){
  const cartItems = document.getElementById("cartItems");
  const totalEl = document.getElementById("total");
  const emptyCart = document.getElementById("emptyCart");
  const placeBtn = document.getElementById("placeOrderBtn");

  if(cart.length === 0){
    cartItems.innerHTML = "";
    emptyCart.style.display = "block";
    placeBtn.style.display = "none";
    totalEl.innerText = "Total: ‚Çπ0";
  } else {
    cartItems.innerHTML = cart.map(i=>`<p>${i.name} - ‚Çπ${i.price}</p>`).join("");
    totalEl.innerText = "Total: ‚Çπ"+total;
    emptyCart.style.display = "none";
    placeBtn.style.display = "block";
  }
}

function placeOrder(){
  if(!localStorage.getItem("vibeera_loggedin_user")){
    alert("Please login first");
    window.location.href="login.html";
    return;
  }

  const name = document.getElementById("name").value;
  const phone = document.getElementById("phone").value;
  const address = document.getElementById("address").value;

  if(!name || !phone || !address){
    alert("Fill all details");
    return;
  }

  customer = {name,phone,address};
  document.getElementById("payAmount").innerText = "‚Çπ"+total;
  document.getElementById("paymentPage").style.display="block";
}

function contactCOD(){
  window.open(`https://wa.me/918423702403?text=I want COD for order of ‚Çπ${total}`);
}

function generateInvoice(){
  emailjs.send("service_4hl3ksn","template_i04e07g",{
    name:customer.name,
    phone:customer.phone,
    address:customer.address,
    order:cart.map(i=>`${i.name} ‚Çπ${i.price}`).join(", "),
    total:total
  });

  let msg = `üÜï NEW ORDER\nName: ${customer.name}\nPhone: ${customer.phone}\nAddress: ${customer.address}\nTotal: ‚Çπ${total}`;
  window.open(`https://wa.me/${OWNER_PHONE}?text=${encodeURIComponent(msg)}`);

  document.querySelector(".cart").style.display="none";
  document.getElementById("billing").style.display="none";
  document.getElementById("paymentPage").style.display="none";

  document.getElementById("invoice").style.display="block";
  document.getElementById("invName").innerText="Name: "+customer.name;
  document.getElementById("invPhone").innerText="Phone: "+customer.phone;
  document.getElementById("invAddress").innerText="Address: "+customer.address;
  document.getElementById("invItems").innerHTML=cart.map(i=>`<p>${i.name} - ‚Çπ${i.price}</p>`).join("");
  document.getElementById("invTotal").innerText="Total: ‚Çπ"+total;

  localStorage.removeItem("vibeera_cart");
  localStorage.removeItem("vibeera_total");
}

renderCart();
</script>

</body>
</html>